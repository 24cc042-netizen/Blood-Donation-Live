{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { initializeApp, getApps } from 'firebase/app';\nimport { getAuth, RecaptchaVerifier, signInWithPhoneNumber } from 'firebase/auth';\nimport { getFirestore, collection, getDocs, query as fsQuery } from 'firebase/firestore';\nimport { getStorage } from 'firebase/storage';\nvar firebaseApp = null;\nif (!getApps().length) {\n  var firebaseConfig = {\n    apiKey: 'YOUR_API_KEY',\n    authDomain: 'YOUR_AUTH_DOMAIN',\n    projectId: 'YOUR_PROJECT_ID',\n    storageBucket: 'YOUR_STORAGE_BUCKET',\n    messagingSenderId: 'YOUR_MESSAGING_SENDER_ID',\n    appId: 'YOUR_APP_ID'\n  };\n  firebaseApp = initializeApp(firebaseConfig);\n}\nexport var auth = getAuth();\nexport var db = getFirestore();\nexport var storage = getStorage();\nexport function createRecaptchaVerifier() {\n  var containerId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'recaptcha-container';\n  try {\n    return new RecaptchaVerifier(containerId, {\n      size: 'invisible'\n    }, auth);\n  } catch (err) {\n    console.warn('Recaptcha not available', err);\n    return null;\n  }\n}\nexport function signInWithPhoneNumberUI(_x, _x2) {\n  return _signInWithPhoneNumberUI.apply(this, arguments);\n}\nfunction _signInWithPhoneNumberUI() {\n  _signInWithPhoneNumberUI = _asyncToGenerator(function* (phoneNumber, verifier) {\n    return signInWithPhoneNumber(auth, phoneNumber, verifier);\n  });\n  return _signInWithPhoneNumberUI.apply(this, arguments);\n}\nexport function fetchAllInstitutions() {\n  return _fetchAllInstitutions.apply(this, arguments);\n}\nfunction _fetchAllInstitutions() {\n  _fetchAllInstitutions = _asyncToGenerator(function* () {\n    try {\n      var q = fsQuery(collection(db, 'institutions'));\n      var snap = yield getDocs(q);\n      var arr = [];\n      snap.forEach(function (doc) {\n        arr.push(_objectSpread({\n          id: doc.id\n        }, doc.data()));\n      });\n      return arr;\n    } catch (err) {\n      console.warn('Failed to fetch institutions', err);\n      return [];\n    }\n  });\n  return _fetchAllInstitutions.apply(this, arguments);\n}\nimport { doc, setDoc } from 'firebase/firestore';\nexport function saveFcmTokenForUser(_x3, _x4) {\n  return _saveFcmTokenForUser.apply(this, arguments);\n}\nfunction _saveFcmTokenForUser() {\n  _saveFcmTokenForUser = _asyncToGenerator(function* (uid, token) {\n    try {\n      if (!uid) return;\n      var ref = doc(db, 'users', uid);\n      yield setDoc(ref, {\n        fcmToken: token\n      }, {\n        merge: true\n      });\n    } catch (e) {\n      console.warn('Failed to save FCM token', e);\n    }\n  });\n  return _saveFcmTokenForUser.apply(this, arguments);\n}","map":{"version":3,"names":["initializeApp","getApps","getAuth","RecaptchaVerifier","signInWithPhoneNumber","getFirestore","collection","getDocs","query","fsQuery","getStorage","firebaseApp","length","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","auth","db","storage","createRecaptchaVerifier","containerId","arguments","undefined","size","err","console","warn","signInWithPhoneNumberUI","_x","_x2","_signInWithPhoneNumberUI","apply","_asyncToGenerator","phoneNumber","verifier","fetchAllInstitutions","_fetchAllInstitutions","q","snap","arr","forEach","doc","push","_objectSpread","id","data","setDoc","saveFcmTokenForUser","_x3","_x4","_saveFcmTokenForUser","uid","token","ref","fcmToken","merge","e"],"sources":["/workspaces/Blood-Donation-Live/lib/firebase.ts"],"sourcesContent":["// Firebase initialization (modular SDK) - fill in config from Firebase console\nimport { initializeApp, getApps } from 'firebase/app';\nimport { getAuth, RecaptchaVerifier, signInWithPhoneNumber } from 'firebase/auth';\nimport { getFirestore, collection, getDocs, query as fsQuery } from 'firebase/firestore';\nimport { getStorage } from 'firebase/storage';\n\nlet firebaseApp: any = null;\nif (!getApps().length) {\n  // TODO: replace these placeholders with your Firebase config\n  const firebaseConfig = {\n    apiKey: 'YOUR_API_KEY',\n    authDomain: 'YOUR_AUTH_DOMAIN',\n    projectId: 'YOUR_PROJECT_ID',\n    storageBucket: 'YOUR_STORAGE_BUCKET',\n    messagingSenderId: 'YOUR_MESSAGING_SENDER_ID',\n    appId: 'YOUR_APP_ID'\n  };\n  firebaseApp = initializeApp(firebaseConfig);\n}\n\nexport const auth = getAuth();\nexport const db = getFirestore();\nexport const storage = getStorage();\n\n// Helper: create a Recaptcha verifier container name for web fallback (expo web)\nexport function createRecaptchaVerifier(containerId = 'recaptcha-container') {\n  try {\n    return new RecaptchaVerifier(containerId, { size: 'invisible' }, auth);\n  } catch (err) {\n    console.warn('Recaptcha not available', err);\n    return null;\n  }\n}\n\n// Example: signInWithPhone wrapper (OTP)\nexport async function signInWithPhoneNumberUI(phoneNumber: string, verifier: any) {\n  return signInWithPhoneNumber(auth, phoneNumber, verifier);\n}\n\n// NOTE: For FCM / push notifications, Expo has a separate flowâ€”implement server/cloud functions to send notifications.\n\n// Helper: fetch all institutions (used to seed offline cache)\nexport async function fetchAllInstitutions() {\n  try {\n    const q = fsQuery(collection(db, 'institutions'));\n    const snap = await getDocs(q);\n    const arr: any[] = [];\n    snap.forEach(doc => {\n      arr.push({ id: doc.id, ...doc.data() });\n    });\n    return arr;\n  } catch (err) {\n    console.warn('Failed to fetch institutions', err);\n    return [];\n  }\n}\n\n// Save device push token to user document for later notification targeting\nimport { doc, setDoc } from 'firebase/firestore';\nexport async function saveFcmTokenForUser(uid: string, token: string) {\n  try {\n    if (!uid) return;\n    const ref = doc(db, 'users', uid);\n    await setDoc(ref, { fcmToken: token }, { merge: true } as any);\n  } catch (e) {\n    console.warn('Failed to save FCM token', e);\n  }\n}\n"],"mappings":";;;;AACA,SAASA,aAAa,EAAEC,OAAO,QAAQ,cAAc;AACrD,SAASC,OAAO,EAAEC,iBAAiB,EAAEC,qBAAqB,QAAQ,eAAe;AACjF,SAASC,YAAY,EAAEC,UAAU,EAAEC,OAAO,EAAEC,KAAK,IAAIC,OAAO,QAAQ,oBAAoB;AACxF,SAASC,UAAU,QAAQ,kBAAkB;AAE7C,IAAIC,WAAgB,GAAG,IAAI;AAC3B,IAAI,CAACV,OAAO,CAAC,CAAC,CAACW,MAAM,EAAE;EAErB,IAAMC,cAAc,GAAG;IACrBC,MAAM,EAAE,cAAc;IACtBC,UAAU,EAAE,kBAAkB;IAC9BC,SAAS,EAAE,iBAAiB;IAC5BC,aAAa,EAAE,qBAAqB;IACpCC,iBAAiB,EAAE,0BAA0B;IAC7CC,KAAK,EAAE;EACT,CAAC;EACDR,WAAW,GAAGX,aAAa,CAACa,cAAc,CAAC;AAC7C;AAEA,OAAO,IAAMO,IAAI,GAAGlB,OAAO,CAAC,CAAC;AAC7B,OAAO,IAAMmB,EAAE,GAAGhB,YAAY,CAAC,CAAC;AAChC,OAAO,IAAMiB,OAAO,GAAGZ,UAAU,CAAC,CAAC;AAGnC,OAAO,SAASa,uBAAuBA,CAAA,EAAsC;EAAA,IAArCC,WAAW,GAAAC,SAAA,CAAAb,MAAA,QAAAa,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAG,qBAAqB;EACzE,IAAI;IACF,OAAO,IAAItB,iBAAiB,CAACqB,WAAW,EAAE;MAAEG,IAAI,EAAE;IAAY,CAAC,EAAEP,IAAI,CAAC;EACxE,CAAC,CAAC,OAAOQ,GAAG,EAAE;IACZC,OAAO,CAACC,IAAI,CAAC,yBAAyB,EAAEF,GAAG,CAAC;IAC5C,OAAO,IAAI;EACb;AACF;AAGA,gBAAsBG,uBAAuBA,CAAAC,EAAA,EAAAC,GAAA;EAAA,OAAAC,wBAAA,CAAAC,KAAA,OAAAV,SAAA;AAAA;AAE5C,SAAAS,yBAAA;EAAAA,wBAAA,GAAAE,iBAAA,CAFM,WAAuCC,WAAmB,EAAEC,QAAa,EAAE;IAChF,OAAOlC,qBAAqB,CAACgB,IAAI,EAAEiB,WAAW,EAAEC,QAAQ,CAAC;EAC3D,CAAC;EAAA,OAAAJ,wBAAA,CAAAC,KAAA,OAAAV,SAAA;AAAA;AAKD,gBAAsBc,oBAAoBA,CAAA;EAAA,OAAAC,qBAAA,CAAAL,KAAA,OAAAV,SAAA;AAAA;AAazC,SAAAe,sBAAA;EAAAA,qBAAA,GAAAJ,iBAAA,CAbM,aAAsC;IAC3C,IAAI;MACF,IAAMK,CAAC,GAAGhC,OAAO,CAACH,UAAU,CAACe,EAAE,EAAE,cAAc,CAAC,CAAC;MACjD,IAAMqB,IAAI,SAASnC,OAAO,CAACkC,CAAC,CAAC;MAC7B,IAAME,GAAU,GAAG,EAAE;MACrBD,IAAI,CAACE,OAAO,CAAC,UAAAC,GAAG,EAAI;QAClBF,GAAG,CAACG,IAAI,CAAAC,aAAA;UAAGC,EAAE,EAAEH,GAAG,CAACG;QAAE,GAAKH,GAAG,CAACI,IAAI,CAAC,CAAC,CAAE,CAAC;MACzC,CAAC,CAAC;MACF,OAAON,GAAG;IACZ,CAAC,CAAC,OAAOf,GAAG,EAAE;MACZC,OAAO,CAACC,IAAI,CAAC,8BAA8B,EAAEF,GAAG,CAAC;MACjD,OAAO,EAAE;IACX;EACF,CAAC;EAAA,OAAAY,qBAAA,CAAAL,KAAA,OAAAV,SAAA;AAAA;AAGD,SAASoB,GAAG,EAAEK,MAAM,QAAQ,oBAAoB;AAChD,gBAAsBC,mBAAmBA,CAAAC,GAAA,EAAAC,GAAA;EAAA,OAAAC,oBAAA,CAAAnB,KAAA,OAAAV,SAAA;AAAA;AAQxC,SAAA6B,qBAAA;EAAAA,oBAAA,GAAAlB,iBAAA,CARM,WAAmCmB,GAAW,EAAEC,KAAa,EAAE;IACpE,IAAI;MACF,IAAI,CAACD,GAAG,EAAE;MACV,IAAME,GAAG,GAAGZ,GAAG,CAACxB,EAAE,EAAE,OAAO,EAAEkC,GAAG,CAAC;MACjC,MAAML,MAAM,CAACO,GAAG,EAAE;QAAEC,QAAQ,EAAEF;MAAM,CAAC,EAAE;QAAEG,KAAK,EAAE;MAAK,CAAQ,CAAC;IAChE,CAAC,CAAC,OAAOC,CAAC,EAAE;MACV/B,OAAO,CAACC,IAAI,CAAC,0BAA0B,EAAE8B,CAAC,CAAC;IAC7C;EACF,CAAC;EAAA,OAAAN,oBAAA,CAAAnB,KAAA,OAAAV,SAAA;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}